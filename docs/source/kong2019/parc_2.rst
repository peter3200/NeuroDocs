Kong2019 Parc Step 2
====================

This step is named "Estimate Group Priors" in the CBIG documentation for this pipeline. However, for the purposes of this tutorial, we will demonstrate how to work with priors previously estimated by CBIG. If the user desires to develop their own priors using their own data, they are encouraged to view the tutorial on training their own priors (https://neurodocs.readthedocs.io/en/latest/kong2019/parc_6.html). 

Priors are Transferable
***********************

Training your own priors has several large disadvantages, mainly data loss. To train your own priors, you would lose ~40 subjects. Due to issues of statistical power, this is typically a costly decision. To avoid this specific issue, we are going to use priors previously trained by CBIG. Previously, it has been demonstrated that MS-HBM parameters estimated from one dataset can be effectively applied to another dataset with significant differences in acquisition and preprocessing (Kong et al., 2021).

Selecting Priors 
****************

Several versions of group priors are available on Github from CBIG. The file that you use will depend on the resolution and "space" of your data. The resolution of your data was specified in Step 1, when you indicated the output resolution in the generate profiles step. 

* fs_LR32K. Available for download at https://github.com/ThomasYeoLab/CBIG/tree/master/stable_projects/brain_parcellation/Kong2019_MSHBM/lib/group_priors/HCP_40. These priors were trained on 40 HCP subjects and the associated optimal parameters (c=40 and alpha=200) can be found on page 10 of the Kong2019 Supplementary Materials. 

* fsaverage5. Available for download at https://github.com/ThomasYeoLab/CBIG/tree/master/stable_projects/brain_parcellation/Kong2019_MSHBM/lib/group_priors/GSP_37. These priors were trained on 37 GSP subjects and the associated optimal parameters (c=30 and alpha=200) can be found on page 10 of the Kong2019 Supplementary Materials. 

* fsaverage6. Priors were obtained via personal correspondence with CBIG: https://github.com/peter3200/NeuroDocs/blob/ccb10c14a04df4b6fdd36751938520adc982ebc6/example_data/Params_Final.mat These priors were generated by taking the fsaverage5 GSP priors and upsampling the spatial probability prior Params.theta to fsaverage6 space. The associated optimal parameters were retained as c=30 and alpha=200. 

.. note:: Be sure to record which priors are being used and their associated optimal parameters. These will come in handy when performing Step 3 and writing your methods section on any publications!

Copy Priors 
***********

Once you have downloaded the selected file to your local computer, you can upload it to Box and use `rclone` to finish the transfer (see tutorial https://neurodocs.readthedocs.io/en/latest/misc/rclone.html) or use the `scp` command to secure copy the file from your computer to the supercomputer. Ultimately, the priors need to end up in parcellation_output_folder/generate_individual_parcellations/priors. 

